{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Spatial Analysis HNSCC Framework Authors: Gregoire Marret , Jinsu An , Farnoosh Abbas Aghababazadeh Contact: gregoire.marret@uhn.ca , jinsu.an@ucalgary.ca , farnoosh.abbasaghababazadeh@uhn.ca Description: A Spatial Analysis Framework for Head and Neck Squamous Cell Carcinoma This repository contains computational workflows for analyzing spatial transcriptomics data from recurrent/metastatic head and neck squamous cell carcinoma (RM-HNSCC). The analyses characterize spatial tumor\u2013immune\u2013stromal organization, infer cell\u2013cell communication, and derive spatially informed gene expression signatures that predict response to immune checkpoint blockade across cancer types. Project Overview This repository serves as the computational companion to a spatial transcriptomics study of RM-HNSCC treated with immune checkpoint blockade. It implements the analytical workflow underlying the manuscript, organizing the full sequence of computational steps required to reproduce the reported results given appropriate data access. The framework supports: preprocessing, integration, and quality control of spatial transcriptomics data; annotation of malignant and non-malignant compartments using orthogonal approaches; modeling of spatial neighborhoods and intercellular communication; extraction of spatial tumor\u2013microenvironment features; and translation of spatial features into gene expression signatures validated in external bulk RNA-seq cohorts. All analyses are implemented as modular, configurable scripts designed for transparency, reproducibility, and extensibility. Protected patient-level data are not distributed in this repository; however, all code required to reproduce the analyses is provided. Reproducibility Modular pipeline implemented in R and Python Dependency management via Pixi Configuration-driven execution to support multiple cohorts and analyses Set Up Prerequisites Pixi is required to run this project. If you haven't installed it yet, follow these instructions Installation # Clone the repository git clone https://github.com/bhklab/spatial-analysis-framework-hnscc.git cd spatial-analysis-framework-hnscc # Install dependencies via Pixi pixi install Repository Structure spatial-analysis-framework-hnscc/ \u251c\u2500\u2500 config/ # YAML config files for each dataset and center \u251c\u2500\u2500 data/ # Raw, processed, and results directories \u251c\u2500\u2500 workflow/ # Scripts for analysis \u251c\u2500\u2500 docs/ # MkDocs-based project documentation \u2502 \u2514\u2500\u2500 README.md # Documentation index and setup instructions \u2514\u2500\u2500 pixi.toml # Pixi environment specification Documentation Full documentation, including usage instructions, data setup, config templates, and pipeline stages, will be available in the docs/ folder or via published GitHub Pages. Start by downloading and organizing the raw input datasets as described in data/rawdata/README.md . For data download and processing, please refer to the univariable repository: \ud83d\udd17 https://github.com/bhklab/spatial-analysis-framework-hnscc?tab=readme-ov-file","title":"Home"},{"location":"#spatial-analysis-hnscc-framework","text":"Authors: Gregoire Marret , Jinsu An , Farnoosh Abbas Aghababazadeh Contact: gregoire.marret@uhn.ca , jinsu.an@ucalgary.ca , farnoosh.abbasaghababazadeh@uhn.ca Description: A Spatial Analysis Framework for Head and Neck Squamous Cell Carcinoma This repository contains computational workflows for analyzing spatial transcriptomics data from recurrent/metastatic head and neck squamous cell carcinoma (RM-HNSCC). The analyses characterize spatial tumor\u2013immune\u2013stromal organization, infer cell\u2013cell communication, and derive spatially informed gene expression signatures that predict response to immune checkpoint blockade across cancer types.","title":"Spatial Analysis HNSCC Framework"},{"location":"#project-overview","text":"This repository serves as the computational companion to a spatial transcriptomics study of RM-HNSCC treated with immune checkpoint blockade. It implements the analytical workflow underlying the manuscript, organizing the full sequence of computational steps required to reproduce the reported results given appropriate data access. The framework supports: preprocessing, integration, and quality control of spatial transcriptomics data; annotation of malignant and non-malignant compartments using orthogonal approaches; modeling of spatial neighborhoods and intercellular communication; extraction of spatial tumor\u2013microenvironment features; and translation of spatial features into gene expression signatures validated in external bulk RNA-seq cohorts. All analyses are implemented as modular, configurable scripts designed for transparency, reproducibility, and extensibility. Protected patient-level data are not distributed in this repository; however, all code required to reproduce the analyses is provided. Reproducibility Modular pipeline implemented in R and Python Dependency management via Pixi Configuration-driven execution to support multiple cohorts and analyses","title":"Project Overview"},{"location":"#set-up","text":"","title":"Set Up"},{"location":"#prerequisites","text":"Pixi is required to run this project. If you haven't installed it yet, follow these instructions","title":"Prerequisites"},{"location":"#installation","text":"# Clone the repository git clone https://github.com/bhklab/spatial-analysis-framework-hnscc.git cd spatial-analysis-framework-hnscc # Install dependencies via Pixi pixi install","title":"Installation"},{"location":"#repository-structure","text":"spatial-analysis-framework-hnscc/ \u251c\u2500\u2500 config/ # YAML config files for each dataset and center \u251c\u2500\u2500 data/ # Raw, processed, and results directories \u251c\u2500\u2500 workflow/ # Scripts for analysis \u251c\u2500\u2500 docs/ # MkDocs-based project documentation \u2502 \u2514\u2500\u2500 README.md # Documentation index and setup instructions \u2514\u2500\u2500 pixi.toml # Pixi environment specification","title":"Repository Structure"},{"location":"#documentation","text":"Full documentation, including usage instructions, data setup, config templates, and pipeline stages, will be available in the docs/ folder or via published GitHub Pages. Start by downloading and organizing the raw input datasets as described in data/rawdata/README.md . For data download and processing, please refer to the univariable repository: \ud83d\udd17 https://github.com/bhklab/spatial-analysis-framework-hnscc?tab=readme-ov-file","title":"Documentation"},{"location":"data_sources/","text":"Data Sources Overview This document summarizes the spatial transcriptomics , Single-cell RNA-seq , bulk RNA-seq , and RNA-based gene signature data sources used in this study. Datasets include private clinical trial cohorts and publicly available reference and validation datasets, curated to ensure reproducibility, transparency, and consistency with the accompanying spatial transcriptomics manuscript. Data Sources Spatial Transcriptomics Data Sources (Discovery Cohort) Spatial transcriptomic profiling was performed on tumor biopsies from patients enrolled in investigator-initiated immune checkpoint blockade (ICB) trials: INSPIRE NCT02644369 IO-KIN NCT04606940 Data type - 10x Genomics Visium spatial transcriptomics from FFPE tissue sections (10 \u03bcm) - Cell Ranger\u2013generated outputs including gene expression matrices, spatial coordinates, and histology images Access - Restricted due to patient privacy and institutional data-use agreements - Data are not publicly distributed Single-Cell RNA-seq Reference Data Public single-cell RNA-seq datasets were used exclusively as reference atlases for cell-type deconvolution and spatial annotation. Source : Gene Expression Omnibus (GEO) - GSE181919 , GSE182227 , GSE188737 Data type : Whole-transcriptome single-cell RNA-seq Access : Public Bulk RNA-seq Data (External Validation Cohorts) Public Validation Datasets Bulk RNA-seq datasets were used to evaluate the generalizability of spatially informed gene expression signatures. Name : Immune Checkpoint Blockade - RNA-Seq, and Clinical data URL : https://www.orcestra.ca/clinical_icb Access Method : Direct download or programmatic retrieval via API (if applicable) Data Format : MultiAssayExperiment and SummarizedExperiment in R (Bioconductor) Access : Public Only cohorts meeting predefined inclusion criteria were used. Private Validation Datasets In addition to publicly available cohorts, selected private bulk RNA-seq datasets were used for external validation of spatially informed gene expression signatures. Data type : Pre-treatment whole-transcriptome bulk RNA-seq with associated clinical outcome annotations Source : Institutional and collaborative immunotherapy cohorts not publicly released Access : Restricted under institutional review board (IRB) approvals and data-sharing agreements These datasets were processed and analyzed using the same harmonization, normalization, and scoring procedures applied to public validation cohorts. Due to patient privacy and consent restrictions, raw data are not redistributed in this repository. Representative private validation cohorts include: Study / Lead Author Trial / Program Cancer Type Data Repository Access Status Ravi et al. SU2C-MAR Non-small cell lung cancer dbGaP / EGA Restricted McDermott et al. IMmotion150 Renal cell carcinoma EGA Restricted Priestley et al. Hartwig Medical Foundation Pan-cancer HMF Restricted Rittmeyer et al. OAK (NCT02008227) Non-small cell lung cancer EGA Restricted Fehrenbacher et al. POPLAR (NCT01903993) Non-small cell lung cancer EGA Restricted Access to these datasets requires approval from the corresponding data custodians and compliance with institutional and ethical data-use agreements. Cohort-level inclusion, preprocessing, and harmonization procedures are described in the Materials and Methods and Supplementary Data of the manuscript. Gene Signature Resources RNA-based gene expression signatures were used for spatial feature scoring, enrichment analysis, and benchmarking. Name : SignatureSets: An R Package for RNA-Based Immuno-Oncology Signatures Version : v1.0 URL - IO Signatures : bhklab/SignatureSets Access Method : Direct download or programmatic retrieval via API (if applicable) Data Format : rda, CSV (signatures, metadata) Signatures were applied using rank-based, enrichment-based, or weighted scoring approaches, depending on the analysis. Key Clinical Variables Clinical annotations were harmonized across datasets when applicable. Key variables include: Variable Description Format Example patientid Unique patient identifier string GSE12345_P01 age Age at diagnosis integer 63 sex Biological sex factor M/F cancer_type Primary cancer type string Melanoma histo Histological classification string Melanoma treatment_type IO therapy category string PD-1/PD-L1 stage Tumor stage at diagnosis string Stage II recist RECIST clinical response factor CR/PR/SD/PD response Clinical benefit status (e.g., response) string R/NR survival_time_os Overall survival time (months) numeric 21.3 event_occurred_os Overall survival event (1 = death) binary 1 survival_time_pfs Progression-free survival time (months) numeric 18.2 event_occurred_pfs Progression-free survival event (1 = progression) binary 1 survival_unit Unit of survival time string months","title":"Data Sources"},{"location":"data_sources/#data-sources","text":"","title":"Data Sources"},{"location":"data_sources/#overview","text":"This document summarizes the spatial transcriptomics , Single-cell RNA-seq , bulk RNA-seq , and RNA-based gene signature data sources used in this study. Datasets include private clinical trial cohorts and publicly available reference and validation datasets, curated to ensure reproducibility, transparency, and consistency with the accompanying spatial transcriptomics manuscript.","title":"Overview"},{"location":"data_sources/#data-sources_1","text":"","title":"Data Sources"},{"location":"data_sources/#spatial-transcriptomics-data-sources-discovery-cohort","text":"Spatial transcriptomic profiling was performed on tumor biopsies from patients enrolled in investigator-initiated immune checkpoint blockade (ICB) trials: INSPIRE NCT02644369 IO-KIN NCT04606940 Data type - 10x Genomics Visium spatial transcriptomics from FFPE tissue sections (10 \u03bcm) - Cell Ranger\u2013generated outputs including gene expression matrices, spatial coordinates, and histology images Access - Restricted due to patient privacy and institutional data-use agreements - Data are not publicly distributed","title":"Spatial Transcriptomics Data Sources (Discovery Cohort)"},{"location":"data_sources/#single-cell-rna-seq-reference-data","text":"Public single-cell RNA-seq datasets were used exclusively as reference atlases for cell-type deconvolution and spatial annotation. Source : Gene Expression Omnibus (GEO) - GSE181919 , GSE182227 , GSE188737 Data type : Whole-transcriptome single-cell RNA-seq Access : Public","title":"Single-Cell RNA-seq Reference Data"},{"location":"data_sources/#bulk-rna-seq-data-external-validation-cohorts","text":"","title":"Bulk RNA-seq Data (External Validation Cohorts)"},{"location":"data_sources/#public-validation-datasets","text":"Bulk RNA-seq datasets were used to evaluate the generalizability of spatially informed gene expression signatures. Name : Immune Checkpoint Blockade - RNA-Seq, and Clinical data URL : https://www.orcestra.ca/clinical_icb Access Method : Direct download or programmatic retrieval via API (if applicable) Data Format : MultiAssayExperiment and SummarizedExperiment in R (Bioconductor) Access : Public Only cohorts meeting predefined inclusion criteria were used.","title":"Public Validation Datasets"},{"location":"data_sources/#private-validation-datasets","text":"In addition to publicly available cohorts, selected private bulk RNA-seq datasets were used for external validation of spatially informed gene expression signatures. Data type : Pre-treatment whole-transcriptome bulk RNA-seq with associated clinical outcome annotations Source : Institutional and collaborative immunotherapy cohorts not publicly released Access : Restricted under institutional review board (IRB) approvals and data-sharing agreements These datasets were processed and analyzed using the same harmonization, normalization, and scoring procedures applied to public validation cohorts. Due to patient privacy and consent restrictions, raw data are not redistributed in this repository. Representative private validation cohorts include: Study / Lead Author Trial / Program Cancer Type Data Repository Access Status Ravi et al. SU2C-MAR Non-small cell lung cancer dbGaP / EGA Restricted McDermott et al. IMmotion150 Renal cell carcinoma EGA Restricted Priestley et al. Hartwig Medical Foundation Pan-cancer HMF Restricted Rittmeyer et al. OAK (NCT02008227) Non-small cell lung cancer EGA Restricted Fehrenbacher et al. POPLAR (NCT01903993) Non-small cell lung cancer EGA Restricted Access to these datasets requires approval from the corresponding data custodians and compliance with institutional and ethical data-use agreements. Cohort-level inclusion, preprocessing, and harmonization procedures are described in the Materials and Methods and Supplementary Data of the manuscript.","title":"Private Validation Datasets"},{"location":"data_sources/#gene-signature-resources","text":"RNA-based gene expression signatures were used for spatial feature scoring, enrichment analysis, and benchmarking. Name : SignatureSets: An R Package for RNA-Based Immuno-Oncology Signatures Version : v1.0 URL - IO Signatures : bhklab/SignatureSets Access Method : Direct download or programmatic retrieval via API (if applicable) Data Format : rda, CSV (signatures, metadata) Signatures were applied using rank-based, enrichment-based, or weighted scoring approaches, depending on the analysis.","title":"Gene Signature Resources"},{"location":"data_sources/#key-clinical-variables","text":"Clinical annotations were harmonized across datasets when applicable. Key variables include: Variable Description Format Example patientid Unique patient identifier string GSE12345_P01 age Age at diagnosis integer 63 sex Biological sex factor M/F cancer_type Primary cancer type string Melanoma histo Histological classification string Melanoma treatment_type IO therapy category string PD-1/PD-L1 stage Tumor stage at diagnosis string Stage II recist RECIST clinical response factor CR/PR/SD/PD response Clinical benefit status (e.g., response) string R/NR survival_time_os Overall survival time (months) numeric 21.3 event_occurred_os Overall survival event (1 = death) binary 1 survival_time_pfs Progression-free survival time (months) numeric 18.2 event_occurred_pfs Progression-free survival event (1 = progression) binary 1 survival_unit Unit of survival time string months","title":"Key Clinical Variables"},{"location":"usage/","text":"Usage Guide This section provides step-by-step instructions to configure, run, and manage your analysis. Project Configuration 1. Customize Configuration Files Edit the YAML files in the config/ directory to reflect your study parameters: - config_rnaseq_io.yaml : For processing raw input into analysis-ready format. Each center should create a center-specific config file using the template: config/<center_or_study_name>.yaml # Example: config/ICB_Gide.yaml Use config/config_local.yaml as a reference. 2. Add Input Data Place your raw input datasets (e.g., .rds files) in the data/rawdata/ directory: data/rawdata/ICB_Gide.rds Also include gene signature metadata files: signature.rda signature_information.csv Precompiled .RData file \u2014 Zenodo DOI: 10.5281/zenodo.18509237 Running Your Analysis 1. Install Dependencies If using pixi : pixi install This sets up your environment with R, Bioconductor, and required packages. 2. Run Local Processing Prepare analysis-ready .rda files from raw data: Rscript workflow/scripts/runProcData.R 3. Run Signature Scoring Rscript workflow/scripts/runSigScore.R 4. Run Association-analysis Rscript workflow/scripts/runSigAssoc.R 5. Run Meta-analysis Rscript workflow/scripts/runMeta.R 6. Generate Visualizations Rscript workflow/scripts/runVisualization.R This script generates forest plots, volcano plots, and heatmaps. Note : runSigCluster.R and runCorr.r are considered to study signatures' distributions. Tips for Managing Your Data Use meaningful filenames (e.g., ICB_Gide__Melanoma__PD-(L)1.rda )","title":"Usage"},{"location":"usage/#usage-guide","text":"This section provides step-by-step instructions to configure, run, and manage your analysis.","title":"Usage Guide"},{"location":"usage/#project-configuration","text":"","title":"Project Configuration"},{"location":"usage/#1-customize-configuration-files","text":"Edit the YAML files in the config/ directory to reflect your study parameters: - config_rnaseq_io.yaml : For processing raw input into analysis-ready format. Each center should create a center-specific config file using the template: config/<center_or_study_name>.yaml # Example: config/ICB_Gide.yaml Use config/config_local.yaml as a reference.","title":"1. Customize Configuration Files"},{"location":"usage/#2-add-input-data","text":"Place your raw input datasets (e.g., .rds files) in the data/rawdata/ directory: data/rawdata/ICB_Gide.rds Also include gene signature metadata files: signature.rda signature_information.csv Precompiled .RData file \u2014 Zenodo DOI: 10.5281/zenodo.18509237","title":"2. Add Input Data"},{"location":"usage/#running-your-analysis","text":"","title":"Running Your Analysis"},{"location":"usage/#1-install-dependencies","text":"If using pixi : pixi install This sets up your environment with R, Bioconductor, and required packages.","title":"1. Install Dependencies"},{"location":"usage/#2-run-local-processing","text":"Prepare analysis-ready .rda files from raw data: Rscript workflow/scripts/runProcData.R","title":"2. Run Local Processing"},{"location":"usage/#3-run-signature-scoring","text":"Rscript workflow/scripts/runSigScore.R","title":"3. Run Signature Scoring"},{"location":"usage/#4-run-association-analysis","text":"Rscript workflow/scripts/runSigAssoc.R","title":"4. Run Association-analysis"},{"location":"usage/#5-run-meta-analysis","text":"Rscript workflow/scripts/runMeta.R","title":"5. Run Meta-analysis"},{"location":"usage/#6-generate-visualizations","text":"Rscript workflow/scripts/runVisualization.R This script generates forest plots, volcano plots, and heatmaps. Note : runSigCluster.R and runCorr.r are considered to study signatures' distributions.","title":"6. Generate Visualizations"},{"location":"usage/#tips-for-managing-your-data","text":"Use meaningful filenames (e.g., ICB_Gide__Melanoma__PD-(L)1.rda )","title":"Tips for Managing Your Data"}]}